/**
 ****************************************************************************************
 *
 * @file main.c
 *
 * @brief 应用程序主入口
 *
 * @details
 * 程序执行流程：
 * 1. 系统初始化：配置时钟
 * 2. 设备初始化：关闭看门狗，初始化调试接口
 * 3. 执行I2C测试程序
 *
 ****************************************************************************************
 */

#include "b6x.h"
#include "drvs.h"
#include "dbg.h"


/*
 * DEFINES
 ****************************************************************************************
 */



/*
 * FUNCTIONS
 ****************************************************************************************
 */

/**
 ****************************************************************************************
 * @brief 系统初始化函数
 *
 * @details
 * 配置系统时钟等基础设置
 ****************************************************************************************
 */
static void sysInit(void)
{
    // 如需配置，在此添加
    rcc_sysclk_set(SYS_CLK);  ///< 设置系统时钟
}

/**
 ****************************************************************************************
 * @brief 设备初始化函数
 *
 * @details
 * 初始化外设和调试接口
 ****************************************************************************************
 */
static void devInit(void)
{
    iwdt_disable();  ///< 禁用独立看门狗
    
    // 初始化调试接口
    dbgInit();       ///< 初始化调试模块
}

extern void i2cTest(void);  ///< 声明I2C测试函数

/**
 ****************************************************************************************
 * @brief 主函数
 *
 * @return int 程序退出状态
 *
 * @details
 * 程序执行主流程：
 * 系统初始化 → 设备初始化 → I2C测试
 ****************************************************************************************
 */
int main(void)
{
    sysInit();    ///< 系统初始化
    
    devInit();    ///< 设备初始化
    
    i2cTest();    ///< 执行I2C测试
}
