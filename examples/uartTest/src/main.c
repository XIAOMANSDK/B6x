/**
 ****************************************************************************************
 *
 * @file main.c
 *
 * @brief 应用程序主入口
 *
 ****************************************************************************************
 */

#include "b6x.h"
#include "drvs.h"
#include "dbg.h"


/*
 * DEFINES
 ****************************************************************************************
 */



/*
 * FUNCTIONS
 ****************************************************************************************
 */

/**
 ****************************************************************************************
 * @brief 系统初始化
 * 
 * @details 执行系统级初始化配置
 ****************************************************************************************
 */
static void sysInit(void)
{
    // 如有需要，在此进行系统级配置
    
}

/**
 ****************************************************************************************
 * @brief 设备初始化
 * 
 * @details 初始化外设设备，包括看门狗和调试功能
 ****************************************************************************************
 */
static void devInit(void)
{
    uint16_t rsn = rstrsn();  // 读取复位原因
    
    iwdt_disable();  // 禁用独立看门狗
    
    dbgInit();  // 初始化调试功能
    debug("Start(rsn:0x%X)...\r\n", rsn);  // 输出启动信息和复位原因
}

extern void uartTest(void);  // 声明UART测试函数

/**
 ****************************************************************************************
 * @brief 主函数 - 程序入口
 * 
 * @return int 程序退出码
 * 
 * @details 程序执行流程：系统初始化 -> 设备初始化 -> UART测试
 ****************************************************************************************
 */
int main(void)
{
    sysInit();      // 系统初始化
    devInit();      // 设备初始化
    
    uartTest();     // 执行UART通信测试
}
